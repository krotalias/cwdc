<!--
    Hierarchical transformation demo.
    Vertex shader does basic Lambert shading.
-->
<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Dancing Blobby</title>
        <link
            href="Dancing_Blobby_files/css.css"
            rel="stylesheet"
            type="text/css"
        />
        <link
            href="Dancing_Blobby_files/Blobby.css"
            rel="stylesheet"
            type="text/css"
        />
    </head>

    <body>
        <div
            id="wrap-container"
            style="text-align: center; font-family: Raleway, sans-serif"
        >
            <h2>
                The Blobby Man
                <span
                    id="fps"
                    style="font-size: x-small; font-family: monospace"
                ></span>
            </h2>

            <div class="dropdown">
                <button
                    id="danceButton"
                    onclick="danceCallBack(true);"
                    style="cursor: pointer; background-color: rgb(230, 66, 0)"
                    title="Dance forever... and ever..."
                >
                    <img
                        src="Dancing_Blobby_files/dance.png"
                        alt="Dance dance"
                        height="70"
                        width="70"
                    />
                </button>
            </div>
            <div class="dropdown">
                <button
                    id="stopButton"
                    onclick="stopCallBack(true)"
                    style="cursor: pointer"
                    title="Stop animation"
                >
                    <img
                        src="Dancing_Blobby_files/stop.png"
                        alt="Dance dance"
                        height="70"
                        width="70"
                    />
                </button>
            </div>
            <div class="dropdown">
                <button
                    id="skinButton"
                    onclick="alternateSkins()"
                    style="cursor: pointer; background-color: rgb(255, 98, 35)"
                    title="Alternate skins between jumps (Single Dancer Mode)"
                >
                    <img
                        src="Dancing_Blobby_files/hand.png"
                        alt="Alternate skins"
                        height="70"
                        width="70"
                    />
                </button>
            </div>
            <div class="dropdown">
                <button
                    id="shutUpButton"
                    onclick="shutUpThatSong()"
                    style="cursor: pointer"
                    title="I cant listen to marena anymore. Please just stop. Shhhh...."
                >
                    <img
                        src="Dancing_Blobby_files/shutUp.png"
                        alt="Shut up macarena!"
                        height="70"
                        width="70"
                    />
                </button>
            </div>
            <div class="dropdown">
                <button
                    id="singleButton"
                    onclick="singleDancer()"
                    style="cursor: pointer; background-color: rgb(255, 98, 35)"
                    title="Single dancer"
                >
                    <img
                        src="Dancing_Blobby_files/single.png"
                        alt="Single Blobby"
                        height="70"
                        width="70"
                    />
                </button>
            </div>
            <div class="dropdown">
                <button
                    id="doubleButton"
                    onclick="doubleDancers()"
                    style="cursor: pointer; background-color: rgb(230, 66, 0)"
                    title="Double trouble. Lets dance!"
                >
                    <img
                        src="Dancing_Blobby_files/double.png"
                        alt="Double trouble. Lets dance!"
                        height="70"
                        width="70"
                    />
                </button>
            </div>
            <br /><br />
            <!-- dropdown container -->
            <div class="dropdown">
                <!-- trigger button -->
                <button>Basic Controls</button>

                <!-- dropdown menu -->
                <ul class="dropdown-menu">
                    <li>
                        <a><b>r, R</b> - rotate scene</a>
                    </li>
                    <li>
                        <a><b>t, T</b> - torso rotation</a>
                    </li>
                    <li>
                        <a><b>s, S</b> - shoulder rotation</a>
                    </li>
                    <li>
                        <a><b>a, A</b> - arm rotation</a>
                    </li>
                </ul>
            </div>

            <!-- dropdown container -->
            <div class="dropdown">
                <!-- trigger button -->
                <button>Basic Poses</button>

                <!-- dropdown menu -->
                <ul class="dropdown-menu">
                    <li>
                        <a><b>u</b> - What's Up?</a>
                    </li>
                    <li>
                        <a><b>i</b> - preparing for wave</a>
                    </li>
                    <li>
                        <a><b>o</b> - hands on hips</a>
                    </li>
                    <li>
                        <a><b>p</b> - bowing down pose</a>
                    </li>
                </ul>
            </div>

            <!-- dropdown container -->
            <div class="dropdown">
                <!-- trigger button -->
                <button>Basic Movements</button>

                <!-- dropdown menu -->
                <ul class="dropdown-menu">
                    <li>
                        <a><b>w</b> - wave Blobby, wave</a>
                    </li>
                    <li>
                        <a><b>b</b> - bow down</a>
                    </li>
                    <li>
                        <a><b>e</b> - the exorcist</a>
                    </li>
                    <li>
                        <a><b>W</b> - raise left arm and sway</a>
                    </li>
                    <li>
                        <a><b>j</b> - jump to the left</a>
                    </li>
                </ul>
            </div>

            <!-- dropdown container -->
            <div class="dropdown">
                <!-- trigger button -->
                <button>Advanced Movements</button>

                <!-- dropdown menu -->
                <ul class="dropdown-menu">
                    <li>
                        <a><b>m</b> - dance macarena</a>
                    </li>
                </ul>
            </div>

            <div class="dropdown">
                <!-- trigger button -->
                <button>Modified Skins</button>

                <!-- dropdown menu -->
                <ul class="dropdown-menu">
                    <li>
                        <a><b>d</b> - default</a>
                    </li>
                    <li>
                        <a><b>v</b> - vampire</a>
                    </li>
                    <!--            <li><a><b>z</b> - zombie</a></li>-->
                    <li>
                        <a><b>c</b> - disco</a>
                    </li>
                    <!--            <li><a><b>n</b> - disco fever</a></li>-->
                </ul>
            </div>

            <br /><br /><br />

            <canvas id="theCanvas" width="1100" height="900">
                Please use a browser that supports "canvas"
            </canvas>

            <audio id="audio" src="Dancing_Blobby_files/macarena.mp3"></audio>
            <audio id="audioGhost" src="Dancing_Blobby_files/ghost.mp3"></audio>
            <audio id="audioHey" src="Dancing_Blobby_files/hey.mp3"></audio>
            <audio
                id="audioWhistle"
                src="Dancing_Blobby_files/whistle.mp3"
            ></audio>

            <img
                id="texImage"
                src="Dancing_Blobby_files/dancefloor2.jpg"
                hidden=""
            />
        </div>

        <script id="vertexLightingShader" type="x-shader/x-vertex">
            uniform mat4 model;
            uniform mat4 view;
            uniform mat4 projection;
            uniform vec4 u_Color;
            uniform mat3 normalMatrix;
            uniform vec4 lightPosition;

            attribute vec4 a_Position;
            attribute vec3 a_Normal;

            varying vec4 color;
            void main()
            {
              float ambientFactor = 0.3;
              vec3 lightDirection = normalize((- view * model * a_Position).xyz);
              //vec3 lightDirection = normalize((view * lightPosition - view * model * a_Position).xyz);
              //vec3 normal = (view * model * vec4(a_Normal, 0.0)).xyz;
              vec3 normal = normalize(normalMatrix * a_Normal);
              float diffuseFactor = 0.8*max(0.0, dot(lightDirection, normal));
              color = u_Color * diffuseFactor + u_Color * ambientFactor;
              color.a = 1.0;
              gl_Position = projection * view * model * a_Position;
            }
        </script>

        <script id="vertexTexturedShader" type="x-shader/x-vertex">
            uniform mat4 model;
            uniform mat4 view;
            uniform mat4 projection;
            uniform vec4 u_Color;
            uniform mat3 normalMatrix;
            uniform vec4 lightPosition;

            attribute vec4 a_Position;
            attribute vec3 a_Normal;
            attribute vec2 vTexCoord;

            varying vec2 fTexCoord;
            varying vec4 color;
            void main()
            {
              float ambientFactor = 0.3;
              vec3 lightDirection = normalize((view * lightPosition - view * model * a_Position).xyz);
              //vec3 normal = (view * model * vec4(a_Normal, 0.0)).xyz;
              vec3 normal = normalize(normalMatrix * a_Normal);
              float diffuseFactor = max(0.0, dot(lightDirection, normal));
              color = u_Color * diffuseFactor + u_Color * ambientFactor;
              color.a = 1.0;
              fTexCoord = vTexCoord;
              gl_Position = projection * view * model * a_Position;
            }
        </script>

        <script id="fragmentLightingShader" type="x-shader/x-fragment">
            precision mediump float;
            varying vec4 color;
            void main()
            {
              gl_FragColor = color;
            }
        </script>

        <script id="fragmentTexturedShader" type="x-shader/x-fragment">
            precision mediump float;
            varying vec4 color;
            varying vec2 fTexCoord;
            uniform sampler2D texture;
            void main()
            {
              gl_FragColor = color * texture2D( texture, fTexCoord );
            }
        </script>

        <script src="/cwdc/13-webgl/lib/teal_book/cuon-utils.js"></script>
        <script src="/cwdc/13-webgl/lib/teal_book/cuon-matrix.js"></script>
        <script src="/cwdc/13-webgl/lib/simple-rotator.js"></script>
        <script src="Dancing_Blobby_files/Blobby.js"></script>

        <script src="/cwdc/13-webgl/lib/three.js"></script>
    </body>
</html>
