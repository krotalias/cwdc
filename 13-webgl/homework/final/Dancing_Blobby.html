<!--
    Hierarchical transformation.
    Vertex shader does basic Lambert shading.
-->
<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Dancing Blobby</title>
        <link
            href="Dancing_Blobby_files/css.css"
            rel="stylesheet"
            type="text/css"
        />
        <link
            href="Dancing_Blobby_files/Blobby.css"
            rel="stylesheet"
            type="text/css"
        />
    </head>

    <body>
        <div
            class="wrap-container"
            style="text-align: center; font-family: Raleway, sans-serif"
        >
            <div style="font-size: 300%; font-weight: bold; margin: 2rem 0">
                Dancing Blobby
                <span
                    id="fps"
                    style="
                        font-size: medium;
                        font-weight: normal;
                        font-family: monospace;
                    "
                ></span>
            </div>

            <div class="button-container" style="margin-bottom: 2rem">
                <div class="dropdown">
                    <button
                        id="danceButton"
                        onclick="danceCallBack(true);"
                        style="cursor: pointer; background-color: #ff6223"
                        title="Dance forever... and ever..."
                    >
                        <img
                            src="Dancing_Blobby_files/dance.png"
                            alt="Dance dance"
                            height="70"
                            width="70"
                        />
                    </button>
                </div>
                <div class="dropdown">
                    <button
                        id="stopButton"
                        onclick="stopCallBack(true)"
                        style="cursor: pointer"
                        title="Stop animation"
                    >
                        <img
                            src="Dancing_Blobby_files/stop.png"
                            alt="Dance dance"
                            height="70"
                            width="70"
                        />
                    </button>
                </div>
                <div class="dropdown">
                    <button
                        id="skinButton"
                        onclick="alternateSkins()"
                        style="cursor: pointer; background-color: #ff6223"
                        title="Alternate skins between jumps (Single Dancer Mode)"
                    >
                        <img
                            src="Dancing_Blobby_files/hand.png"
                            alt="Alternate skins"
                            height="70"
                            width="70"
                        />
                    </button>
                </div>
                <div class="dropdown">
                    <button
                        id="shutUpButton"
                        onclick="shutUpThatSong()"
                        style="cursor: pointer"
                        title="I cant listen to marena anymore. Please just stop. Shhhh...."
                    >
                        <img
                            src="Dancing_Blobby_files/shutUp.png"
                            alt="Shut up macarena!"
                            height="70"
                            width="70"
                        />
                    </button>
                </div>
                <div class="dropdown">
                    <button
                        id="singleButton"
                        onclick="singleDancer()"
                        style="cursor: pointer; background-color: #e64200"
                        title="Single dancer"
                    >
                        <img
                            src="Dancing_Blobby_files/single.png"
                            alt="Single Blobby"
                            height="70"
                            width="70"
                        />
                    </button>
                </div>
                <div class="dropdown">
                    <button
                        id="doubleButton"
                        onclick="doubleDancers()"
                        style="cursor: pointer; background-color: #ff6223"
                        title="Double trouble. Lets dance!"
                    >
                        <img
                            src="Dancing_Blobby_files/double.png"
                            alt="Double trouble. Lets dance!"
                            height="70"
                            width="70"
                        />
                    </button>
                </div>
            </div>

            <div class="dropdown-container" style="margin-bottom: 2rem">
                <div class="dropdown">
                    <button>Basic Rotation Controls</button>

                    <ul class="dropdown-menu">
                        <li>
                            <a><b>r, R</b> - scene</a>
                        </li>
                        <li>
                            <a><b>t, T</b> - torso</a>
                        </li>
                        <li>
                            <a><b>s, S</b> - shoulder</a>
                        </li>
                        <li>
                            <a><b>a, A</b> - arm</a>
                        </li>
                    </ul>
                </div>

                <div class="dropdown">
                    <button>Basic Static Poses</button>

                    <ul class="dropdown-menu">
                        <li>
                            <a><b>u</b> - What's Up?</a>
                        </li>
                        <li>
                            <a><b>i</b> - wave</a>
                        </li>
                        <li>
                            <a><b>o</b> - hands on hips</a>
                        </li>
                        <li>
                            <a><b>p</b> - bow down</a>
                        </li>
                    </ul>
                </div>

                <div class="dropdown">
                    <button>Basic Movements</button>

                    <ul class="dropdown-menu">
                        <li>
                            <a
                                href="javascript:void(0)"
                                onclick="javascript:bwave();"
                            >
                                <b>w</b> - wave</a
                            >
                        </li>
                        <li>
                            <a
                                href="javascript:void(0)"
                                onclick="javascript:bdown();"
                            >
                                <b>b</b> - bow down
                            </a>
                        </li>
                        <li>
                            <a
                                href="javascript:void(0)"
                                onclick="javascript:exorcist();"
                            >
                                <b>e</b> - exorcist
                            </a>
                        </li>
                        <li>
                            <a
                                href="javascript:void(0)"
                                onclick="javascript:blarmup();"
                            >
                                <b>W</b> - left arm up
                            </a>
                        </li>
                        <li>
                            <a
                                href="javascript:void(0)"
                                onclick="javascript:bljump();"
                            >
                                <b>j</b> - left jump
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="dropdown">
                    <button>Advanced Movements</button>

                    <ul class="dropdown-menu">
                        <li>
                            <a><b>m</b> - dance macarena</a>
                        </li>
                    </ul>
                </div>

                <div class="dropdown">
                    <button>Modified Skins</button>

                    <ul class="dropdown-menu">
                        <li>
                            <a><b>d</b> - default</a>
                        </li>
                        <li>
                            <a><b>v</b> - vampire</a>
                        </li>
                        <!--            <li><a><b>z</b> - zombie</a></li>-->
                        <li>
                            <a><b>c</b> - disco</a>
                        </li>
                        <!--            <li><a><b>n</b> - disco fever</a></li>-->
                    </ul>
                </div>
            </div>

            <canvas id="theCanvas" width="1100" height="900">
                Please use a browser that supports "canvas"
            </canvas>

            <audio id="audio" src="Dancing_Blobby_files/macarena.mp3"></audio>
            <audio id="audioGhost" src="Dancing_Blobby_files/ghost.mp3"></audio>
            <audio id="audioHey" src="Dancing_Blobby_files/hey.mp3"></audio>
            <audio
                id="audioWhistle"
                src="Dancing_Blobby_files/whistle.mp3"
            ></audio>

            <img
                id="texImage"
                src="Dancing_Blobby_files/dancefloor2.jpg"
                hidden=""
            />
        </div>

        <!-- prettier-ignore -->
        <script id="vertexLightingShader" type="x-shader/x-vertex">#version 300 es
            uniform mat4 model;
            uniform mat4 view;
            uniform mat4 projection;
            uniform vec4 u_Color;
            uniform mat3 normalMatrix;
            uniform vec4 lightPosition;

            in vec4 a_Position;
            in vec3 a_Normal;

            out vec4 color;
            void main()
            {
              const float ambientFactor = 0.3;
              vec3 lightDirection = normalize((- view * model * a_Position).xyz);
              //vec3 lightDirection = normalize((view * lightPosition - view * model * a_Position).xyz);
              //vec3 normal = (view * model * vec4(a_Normal, 0.0)).xyz;
              vec3 normal = normalize(normalMatrix * a_Normal);
              float diffuseFactor = 0.8*max(0.0, dot(lightDirection, normal));
              color = u_Color * diffuseFactor + u_Color * ambientFactor;
              color.a = 1.0;
              gl_Position = projection * view * model * a_Position;
            }
        </script>

        <!-- prettier-ignore -->
        <script id="vertexTexturedShader" type="x-shader/x-vertex">#version 300 es
            uniform mat4 model;
            uniform mat4 view;
            uniform mat4 projection;
            uniform vec4 u_Color;
            uniform mat3 normalMatrix;
            uniform vec4 lightPosition;

            in vec4 a_Position;
            in vec3 a_Normal;
            in vec2 vTexCoord;

            out vec2 fTexCoord;
            out vec4 color;
            void main()
            {
              const float ambientFactor = 0.3;
              vec3 lightDirection = normalize((view * lightPosition - view * model * a_Position).xyz);
              //vec3 normal = (view * model * vec4(a_Normal, 0.0)).xyz;
              vec3 normal = normalize(normalMatrix * a_Normal);
              float diffuseFactor = max(0.0, dot(lightDirection, normal));
              color = u_Color * diffuseFactor + u_Color * ambientFactor;
              color.a = 1.0;
              fTexCoord = vTexCoord;
              gl_Position = projection * view * model * a_Position;
            }
        </script>

        <!-- prettier-ignore -->
        <script id="fragmentLightingShader" type="x-shader/x-fragment">#version 300 es
            precision mediump float;
            out vec4 fragColor;
            in vec4 color;
            void main()
            {
              fragColor = color;
            }
        </script>

        <!-- prettier-ignore -->
        <script id="fragmentTexturedShader" type="x-shader/x-fragment">#version 300 es
            precision mediump float;
            out vec4 fragColor;
            uniform sampler2D sampler;
            in vec2 fTexCoord;
            in vec4 color;

            void main()
            {
              // sample from the texture at interpolated texture coordinate
              vec4 texColor = texture(sampler, fTexCoord);
              fragColor = color * texColor;
            }
        </script>

        <script src="/cwdc/13-webgl/lib/teal_book/cuon-utils.js"></script>
        <script src="/cwdc/13-webgl/lib/teal_book/cuon-matrix.js"></script>
        <script src="/cwdc/13-webgl/lib/simple-rotator.js"></script>
        <script src="Dancing_Blobby_files/Blobby.js"></script>

        <script src="/cwdc/13-webgl/lib/three.js"></script>
    </body>
</html>
