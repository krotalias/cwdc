<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: tic-tac-toe.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: tic-tac-toe.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file
 *
 * Summary.
 * &lt;p>A tic-tac-toe game implemented with {@link https://reactjs.org|React}.&lt;/p>
 *
 * {@link https://en.wikipedia.org/wiki/Tic-tac-toe|Tic-tac-toe} (American English),
 * noughts and crosses (Commonwealth English and British English),
 * or Xs and Os/“X’y O’sies” (Ireland), is a paper-and-pencil game for two players, X and O,
 * who take turns marking the spaces in a 3×3 grid.
 * The player who succeeds in placing three of their marks in a diagonal, horizontal,
 * or vertical row is the winner.
 * It is a solved game with a forced draw assuming best play from both players.
 *
 * &lt;p>&lt;b>Important remark&lt;/b>: using React without {@link https://nodejs.dev/en/ nodejs}
 * is a great way to try React, but it's not suitable for production.&lt;br>
 * It slowly compiles {@link https://react.dev/learn/javascript-in-jsx-with-curly-braces JSX}
 * with Babel in the browser, and uses a large development build of React.
 *
 * &lt;ul>
 *    &lt;li> Read this {@link  https://reactjs.org/docs/add-react-to-a-website.html#add-jsx-to-a-project section}
 *    for a production-ready setup with JSX.&lt;/li>
 *
 *    &lt;li>In a larger project, you can use an
 *    {@link https://reactjs.org/docs/create-a-new-react-app.html integrated toolchain}
 *    that includes JSX instead.&lt;/li>
 *
 *    &lt;li>You can also use React {@link https://reactjs.org/docs/react-without-jsx.html without JSX},
 *    in which case you can remove Babel.&lt;/li>
 * &lt;/ul>
 *
 * Finally, when an application is ready for the world,
 * it must be {@link https://create-react-app.dev/docs/deployment/ deployed} somehow.
 *
 * &lt;p>Usage: &lt;/p>
 * &lt;ul>
 *  &lt;li>To install jsdoc and yarn:&lt;/li>
 *  &lt;ul>
 *    &lt;li>sudo npm install --global yarn&lt;/li>
 *    &lt;li>sudo npm install -g jsdoc&lt;/li>
 *  &lt;/ul>
 *  &lt;li>To run react in the browser, then run {@link https://babeljs.io Babel} on the fly,
 *  and save the "compiled" output when the source has changed:&lt;/li>
 *  &lt;ul>
 *    &lt;li>npm init -y&lt;/li>
 *    &lt;li>npm install babel-cli@6 babel-preset-react-app@3&lt;/li>
 *    &lt;li>npx babel --watch src --out-dir . --presets react-app/prod &amp;&lt;/li>
 *  &lt;/ul>
 *
 *  &lt;li>To run the version with modules and Node.js version {@link https://nodejs.org/en/blog/release/v16.16.0 16}
 *  or {@link https://nodejs.org/en/blog/release/v18.16.0 18}:&lt;/li>
 *  &lt;ul>
 *    &lt;li>cd counter-app&lt;/li>
 *    &lt;li>{@link https://www.npmjs.com npm} or {@link https://yarnpkg.com yarn} install&lt;/li>
 *    &lt;li>{@link https://www.npmjs.com/package/react npm} or {@link https://yarnpkg.com/package/react yarn} start&lt;/li>
 *  &lt;/ul>
 * &lt;/ul>
 *
 * @author Paulo Roma based on {@link https://opensource.fb.com|Facebook Open Source}
 * @since 17/09/2021
 * @see &lt;a href="../src/tic-tac-toe.js">source&lt;/a>
 * @see &lt;a href="../tic-tac-toe.js">source compiled (Babel)&lt;/a>
 * @see &lt;a href="../package.json">package.json&lt;/a>
 * @see &lt;a href="/cwdc/14-react/tic-tac-toe/tic-tac-toe.html">link&lt;/a>
 * @see https://reactjs.org/tutorial/tutorial.html#overview
 * @see https://flarnie.github.io/react/tutorial/tutorial.html
 * @see https://reactjs.org/docs/react-dom.html
 * @see https://reactjs.org/docs/react-api.html#createelement
 * @see https://reactjs.org/docs/add-react-to-a-website.html
 * @see https://legacy.reactjs.org/docs/faq-build.html
 * @see &lt;img src="../tic-tac-toe.png">
 */

"use strict";

/**
 * React module.
 * @external react
 * @see https://legacy.reactjs.org/docs/react-api.html
 */

/**
 * React DOM module.
 * @external react-dom
 * @see https://legacy.reactjs.org/docs/react-dom.html
 */

/**
 * Create React App is a comfortable environment for learning React,
 * and is the best way to start building a new single-page application in React.
 * It sets up your development environment so that you can use the latest JavaScript features,
 * provides a nice developer experience, and optimizes your app for production.
 * @class React
 * @memberof external:react
 * @see https://legacy.reactjs.org/docs/create-a-new-react-app.html
 */

/**
 * React lets you define components as classes or functions.
 * Components defined as classes currently provide more features which are described in detail on this page.
 * To define a React component class, you need to extend React.Component.
 *
 * &lt;p>The only method you must define in a React.Component subclass is called render().
 * All the other methods described on this page are optional.&lt;/p>
 * @class React.Component
 * @memberof React
 * @see https://legacy.reactjs.org/docs/react-component.html
 * @see https://react.dev/reference/react/Component
 */

/**
 * &lt;p>A function component.&lt;/p>
 * &lt;p>In React, {@link https://legacy.reactjs.org/docs/components-and-props.html function components}
 * are a simpler way to write components that
 * only contain a render method and don’t have their own state.&lt;/p>
 *
 * Since the Square components no longer maintain state, the Square components
 * receive values from the {@link Board} component and inform the Board component when they’re clicked.
 * In React terms, the Square components are now
 * {@link https://stackoverflow.com/questions/42522515/what-are-react-controlled-components-and-uncontrolled-components controlled components}.
 * The Board has full control over them.
 *
 * @param {Object} props React Props.
 * @param {Number} props.value an index ∈ [0..8].
 * @param {Game#handleClick} props.onClick button onClick callback.
 * @returns {HTMLButtonElement} a &amp;lt;button&amp;gt; tag with the given props.
 * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment
 * @see https://indepth.dev/posts/1360/getting-started-with-modern-javascript-destructuring
 * @see https://javascript.info/destructuring-assignment
 */
function Square({ value, onClick } = props) {
  return (
    &lt;button className="square" onClick={onClick}>
      {value}
    &lt;/button>
  );
}

/**
 * &lt;p>The board class.&lt;/p>
 *
 * Basically, it renders the layout of the game,
 * by creating a 3 × 3 grid with a button for each square.
 *
 * &lt;p>Board takes squares via props and has its own onClick prop specified by {@link Game}.&lt;/p>
 * When you want to aggregate data from multiple children or to have two child components communicate with each other,
 * move the state upwards so that it lives in the parent component.
 * The parent can then pass the state back down to the children via props,
 * so that the child components are always in sync with each other and with the parent.
 * All of this is possible because of {@link https://levelup.gitconnected.com/unlocking-the-power-of-closures-in-react-components-ba5903f4710a closures}.
 * @extends {React.Component}
 */
class Board extends React.Component {
  /**
   * Board constructor.
   * @param {Object} props component input.
   * @param {Array&lt;String>} props.squares current array with their 9 squares.
   * @param {Game#handleClick} props.onClick button onClick callback.
   * @extends {React.Component&lt;Props>}
   * @see https://reactjs.org/docs/react-component.html
   */
  constructor(props) {
    super(props);
    console.log("Board props: ", props);
  }

  /**
   * We’ll pass down a prop, from the Board to the Square,
   * with a value and function, and we’ll have Square call
   * that function when a square is clicked.
   *
   * @param {Number} i square index ∈ [0..8].
   * @returns {Square} the i-th square with its value and click callback.
   */
  renderSquare(i) {
    return (
      &lt;Square
        value={this.props.squares[i]}
        onClick={() => this.props.onClick(i)}
      />
    );
  }

  /**
   * Renders the 9 squares of the board.
   * @returns {HTMLDivElement} a &amp;lt;div&amp;gt; tag with a 3 × 3 grid layout, with 3
   * buttons per row, each of which with value 'X', 'O' or null.
   * @memberof React.Component
   * @see https://legacy.reactjs.org/docs/react-component.html#render
   */
  render() {
    return (
      &lt;div>
        &lt;div className="board-row">
          {this.renderSquare(0)}
          {this.renderSquare(1)}
          {this.renderSquare(2)}
        &lt;/div>
        &lt;div className="board-row">
          {this.renderSquare(3)}
          {this.renderSquare(4)}
          {this.renderSquare(5)}
        &lt;/div>
        &lt;div className="board-row">
          {this.renderSquare(6)}
          {this.renderSquare(7)}
          {this.renderSquare(8)}
        &lt;/div>
      &lt;/div>
    );
  }
}

/**
 * &lt;p>Game class.&lt;/p>
 *
 * To “remember” things, components use {@link https://legacy.reactjs.org/docs/faq-state.html state}.
 * React components can have state by setting &lt;strong>this.state&lt;/strong>
 * in their constructors, which should be considered as private
 * to a React component that it’s defined in.
 *
 * &lt;p>To add a Time Travel, to “go back in time” to the previous moves in the game,
 * we need a History of Moves.&lt;/p>
 *
 * We’ll store the past squares arrays in another array called {@link Game#state history}.
 * The history array represents all board states,
 * from the first to the last move.
 */
class Game extends React.Component {
  /**
   * &lt;ul>
   *    &lt;li>Set up the initial state of the game: board configuration,
   *    number of moves and if "X" is the next to play.&lt;/li>
   *    &lt;li>Set the Board’s initial state to contain an array of 9 nulls
   *    corresponding to the 9 squares.&lt;/li>
   *  &lt;/ul>
   * &lt;p>Conceptually, components are like JavaScript functions:&lt;/p>
   * &lt;ul>
   *    &lt;li>They accept arbitrary inputs (called “props”) and &lt;/li>
   *    &lt;li>return React elements describing what should appear on the screen.&lt;/li>
   * &lt;/ul>
   *
   * @param {Object} props component input.
   * @extends {React.Component&lt;Props>}
   * @see https://reactjs.org/docs/react-component.html
   */
  constructor(props) {
    super(props);
    console.log("Game props: ", props);

    /**
     * The state of the game.
     * @type {Object}
     * @property {Array&lt;Object&lt;{squares: Array&lt;String>}>>} state.history history array.
     * @property {Number} state.stepNumber step number.
     * @property {Boolean} state.xIsNext player turn.
     * @property {state_setter} state.setState setter - change state.
     */
    this.state = {
      history: [
        {
          squares: Array(9).fill(null),
        },
      ],
      stepNumber: 0,
      xIsNext: true,
    };
  }

  /**
   * &lt;p>The {@link Square} calls this.handleClick(i) when clicked.&lt;/p>
   *
   * &lt;p>Each time a player moves, {@link Game#state xIsNext} (a boolean) will be flipped to determine
   * which player goes next, and the game’s state will be saved.&lt;/p>
   *
   * &lt;p>If you “go back in time” and then make a new move from that point,
   * you only want to keep the history up to that point.
   * Instead of adding nextSquares after all items in history,
   * you’ll add it after all items in history.slice(0, stepNumber + 1),
   * so that you’re only keeping that portion of the old history.&lt;/p>
   *
   * &lt;p>Note how in handleClick, we call
   * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice slice()}
   * to create a copy of the squares array, instead of modifying the existing array.&lt;/p>
   *
   * &lt;p>To explain why, we need to discuss
   * {@link https://blog.devgenius.io/mutable-and-immutable-in-javascript-78a3cbc6187c immutability},
   * and why immutability is important to learn.&lt;/p>
   *
   * &lt;p>There are generally two approaches to changing data:&lt;/p>
   * &lt;ol>
   *  &lt;li>The first approach is to mutate the data, by directly changing the data’s values.&lt;/li>
   *  &lt;li>The second approach is to replace the data with a new copy, which has the desired changes.&lt;/li>
   * &lt;/ol>
   *
   * Detecting changes in immutable objects is considerably easier:
   * &lt;ul>
   *  &lt;li>if the immutable object that is being referenced is different than the previous one,
   *  then the object has changed.&lt;/li>
   * &lt;/ul>
   *
   * @param {Number} i an index ∈ [0..8] corresponding to the button clicked.
   * @see https://reactjs.org/docs/react-component.html#setstate
   * @see https://www.codecademy.com/resources/docs/javascript/arrays/slice
   */
  handleClick(i) {
    // a copy of the current history up to stepNumber.
    const history = this.state.history.slice(0, this.state.stepNumber + 1);
    // the last configuration.
    const current = history[history.length - 1];
    // a copy of the last array of "X"s and "O"s from the copied history.
    const nextSquares = current.squares.slice();
    // check for a winner or if the i-th square has been already marked.
    if (calculateWinner(nextSquares) || nextSquares[i]) {
      return;
    }
    nextSquares[i] = this.state.xIsNext ? "X" : "O";

    /**
     * &lt;p>Add the new configuration (another square array) to {@link Game#state history}.&lt;/p>
     * &lt;pre>
     * History: Array (5) = $2
     *  0 {squares: Array}
     *      squares: [null, null, null, null, null, null, null, null, null] (9)
     *  1 {squares: Array}
     *      squares: ["X", null, null, null, null, null, null, null, null] (9)
     *  2 {squares: Array}
     *      squares: ["X", null, null, null, null, null, null, null, "O"] (9)
     *  3 {squares: Array}
     *      squares: ["X", null, null, null, "X", null, null, null, "O"] (9)
     *  4 {squares: Array}
     *      squares: ["X", null, "O", null, "X", null, null, null, "O"] (9)
     * &lt;/pre>
     * When you call {@link https://react.dev/reference/react/useState setState} in a component,
     * React automatically updates the child components inside of it too.
     * @callback state_setter
     * @see https://www.geeksforgeeks.org/reactjs-setstate/
     * @see https://dev.to/johnstonlogan/react-hooks-barney-style-1hk7
     */
    this.setState({
      // creates a new array that contains all the items in history,
      // followed by nextSquares (could have been used concat instead of spread).
      history: [...history, { squares: nextSquares }],
      stepNumber: history.length,
      xIsNext: !this.state.xIsNext,
    });
  }

  /**
   * &lt;p>Go to the step-th move in the game.&lt;/p>
   *
   * &lt;p>Enqueues changes to the component state and tells React that this component and
   * its children need to be re-rendered with the updated state.&lt;/p>
   *
   * This is the primary method you use to update the user interface in response
   * to event handlers and server responses.
   *
   * @param {Number} step position into the history array.
   * @see https://reactjs.org/docs/react-component.html#setstate
   */
  jumpTo(step) {
    this.setState({
      stepNumber: step,
      xIsNext: step % 2 === 0,
    });
  }

  /**
   * Renders the grid layout and an ordered list of buttons for each move in this game history.
   *
   * @returns {HTMLDivElement} a tag &amp;lt;game&amp;gt;, with the 3 × 3 {@link Board} grid layout and
   * an ordered list of buttons for the time travel.
   * @memberof React.Component
   * @see https://legacy.reactjs.org/docs/react-component.html#render
   * @see https://www.w3schools.com/react/react_props.asp
   */
  render() {
    const history = this.state.history;
    const current = history[this.state.stepNumber];
    const winner = calculateWinner(current.squares);

    /**
     * &lt;p>Creates buttons for each move in history.&lt;/p>
     * &lt;pre>
     *    0: {$$typeof: Symbol(react.element), type: "li", key: "0", ref: null, props: Object, …}
     *    1: {$$typeof: Symbol(react.element), type: "li", key: "1", ref: null, props: Object, …}
     *    ...
     * &lt;/pre>
     * @type {Array&lt;react.element>}
     */
    const moves = history.map((step, move) => {
      //                      go to   #move     or   when move is 0
      const desc = move ? `Go to move #${move}` : "Go to game start";
      return (
        &lt;li key={move}>
          &lt;button onClick={() => this.jumpTo(move)}>{desc}&lt;/button>
        &lt;/li>
      );
    });

    let status;
    if (winner) {
      status = `Winner: ${winner}`;
    } else if (this.state.stepNumber > 8) {
      status = "Game Over: Draw";
    } else {
      status = `Next player: ${this.state.xIsNext ? "X" : "O"}`;
    }

    /**
     * This is really beautiful.
     * {@link Board} is going to draw the configuration indicated by stepNumber,
     * used to get the current entry into the history array.
     * The Board component receives the arguments (squares, onClick) as a props object.
     */
    return (
      &lt;div className="game">
        &lt;div className="game-board">
          &lt;div>
            &lt;p style={{ textAlign: "center" }}>{status}&lt;/p>
          &lt;/div>
          &lt;Board
            squares={current.squares}
            onClick={(i) => this.handleClick(i)}
          />
        &lt;/div>
        &lt;div className="game-info">
          &lt;p style={{ textAlign: "center" }}>History&lt;/p>
          &lt;ol>{moves}&lt;/ol>
        &lt;/div>
      &lt;/div>
    );
  }
}

// ========================================

/**
 * Render a React element into the DOM in the supplied container and
 * return a reference to the component (or returns null for stateless components).
 * &lt;p>Deprecated.&lt;/p>
 * @method render
 * @memberof external:react-dom
 * @see https://reactjs.org/docs/react-dom.html#render
 * @see https://react.dev/reference/react-dom/render
 */
// ReactDOM.render(&lt;Game />, document.getElementById("tic-tac-toe"));

/**
 * Create a root to display React components inside a browser DOM node.
 * After you’ve created a root, you need to call root.render to display a React component inside of it.
 * @method createRoot
 * @memberof external:react-dom
 * @see https://react.dev/reference/react-dom/client/createRoot
 */
const root = ReactDOM.createRoot(document.getElementById("tic-tac-toe"));
root.render(&lt;Game />);

/**
 * Given an array of 9 squares, this function will check
 * for a winner and return 'X', 'O', or null as appropriate.
 *
 * @param {Array&lt;String>} squares a given array of 9 squares.
 * @returns {String} &lt;p>the winner: "X", "O", or null if there is not a winner.&lt;/p>
 */
function calculateWinner(squares) {
  // The eight winner configurations: rows, columns and diagonals.
  const lines = [
    [0, 1, 2],
    [3, 4, 5],
    [6, 7, 8],
    [0, 3, 6],
    [1, 4, 7],
    [2, 5, 8],
    [0, 4, 8],
    [2, 4, 6],
  ];
  for (const [a, b, c] of lines) {
    if (squares[a] &amp;&amp; squares[a] === squares[b] &amp;&amp; squares[a] === squares[c]) {
      return squares[a];
    }
  }
  return null;
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Externals</h3><ul><li><a href="external-react.html">react</a></li><li><a href="external-react-dom.html">react-dom</a></li></ul><h3>Classes</h3><ul><li><a href="Board.html">Board</a></li><li><a href="Game.html">Game</a></li><li><a href="React.Component.html">Component</a></li><li><a href="external-react.React.html">React</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Square">Square</a></li><li><a href="global.html#calculateWinner">calculateWinner</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Sat Dec 16 2023 07:04:28 GMT-0300 (Brasilia Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
