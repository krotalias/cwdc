<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: cookies.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: cookies.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 *  @file
 *
 *  Cookies are data, stored in small text files, on your computer.
 *  &lt;p>
 *  When a web server has sent a web page to a browser, the connection is shut down, and the server forgets everything about the user.
 *  &lt;/p>
 *  Cookies were invented to solve the problem "how to remember information about the user":
 *  &lt;p>
 *  When a user visits a web page, his/her name can be stored in a cookie.
 *  Next time the user visits the page, the cookie "remembers" his/her name.&lt;br>
 *  Cookies are saved in name-value pairs like:
 *  &lt;/p>
 *  username = John Doe
 *  &lt;p>
 *  When a browser requests a web page from a server, cookies belonging to the page are added to the request. &lt;br>
 *  This way the server gets the necessary data to "remember" information about users.
 *  &lt;/p>
 *  @author Paulo Roma.
 *  @since 05/05/2021
 *  @see &lt;a href="/cwdc/3-javascript/cookies.html">link&lt;/a>
 *  @see &lt;a href="/cwdc/3-javascript/cookies.js">source&lt;/a>
 *  @see &lt;a href="../../7-mysql/showcode.php?f=8.7">php&lt;/a>
 *  @see https://www.w3schools.com/js/js_cookies.asp
 *  @see https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie
 *  @see https://alightanalytics.com/alight-insights/safari-first-party-cookies/
 */
"use strict";

/** Set a Cookie.
 *
 *  @param {String} cname name of the cookie.
 *  @param {String} cvalue the value of the cookie.
 *  @param {Number} exdays the number of days until the cookie should expire.
 *  @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toUTCString
 *  @see https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie
 */
function setCookie(cname, cvalue, exdays) {
  var d = new Date();
  // Default at 365 days.
  exdays = exdays || 365;
  // Get unix milliseconds at current time plus number of days
  d.setTime(d.getTime() + exdays * 24 * 60 * 60 * 1000);
  var expires = "expires=" + d.toUTCString();
  // cvalue must be encoded because it can be utf-8
  document.cookie = `${cname}=${encodeURIComponent(cvalue)};${expires};path=/`; // cname + "=" + cvalue + ";" + expires + ";path=/";
  // console.log(document.cookie);
  // username=Paulo Roma; __utma=30314110.38272483.1627839402.1627839402.1627839402.1; __utmc=30314110; __utmz=30314110.1627839402.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
}

/** Deleting a cookie is very simple.
 *
 *  You don't have to specify a cookie value when you delete a cookie.
 *  Just set the expires parameter to a passed date.
 *
 *  @param {String} cname name of the cookie.
 */
function deleteCookie(cname) {
  document.cookie = `${cname}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`;
  // console.log(document.cookie);
}

/** &lt;p>Returns the value of a specified cookie.&lt;/p>
 *
 * console.log(decodeURIComponent(document.cookie).split(';'));&lt;br>
 * Array (4)
 * &lt;ul style="list-style-type:none;">
 *  &lt;li> 0 "username=Paulo Roma" &lt;/li>
 *  &lt;li> 1 " __utma=30314110.38272483.1627839402.1627839402.1627839402.1" &lt;/li>
 *  &lt;li> 2 " __utmc=30314110" &lt;/li>
 *  &lt;li> 3 " __utmz=30314110.1627839402.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)" &lt;/li>
 * &lt;/ul>
 *
 *  @param {String} cname name of the cookie.
 *  @return {String} the value of the cookie.
 *  @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/substring
 *  @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith
 *  @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/indexOf
 *  @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find
 */
function getCookie(cname) {
  var name = cname.trimStart() + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(";");

  let cookie = ca.find((row) => row.trim().startsWith(name));
  return cookie == undefined ? "" : cookie.split("=")[1];
}

/** Check a Cookie.
 *  If the cookie is set it will display a greeting.
 *  &lt;p>
 *  If the cookie is not set, it will display a prompt box, asking for the value of the cookie,
 *  and stores the cookie for 30 days, by calling setCookie.
 *  &lt;/p>
 * @param {String} cname name of the cookie.
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/prepend
 */
function checkCookie(cname) {
  var user = getCookie(cname);
  if (user != "") {
    //alert(`Welcome back ${user}`);
    let div = document.querySelector(".square");
    const para = document.createElement("h2");
    const node = document.createTextNode(`Welcome back ${user}`);
    para.appendChild(node);
    div.prepend(para);
  } else {
    user = prompt("Please enter your name:", "");
    if (user != "" &amp;&amp; user != null) {
      setCookie(cname, user, 30);
      displayAllCookies();
    }
  }
}

/**
 * Display all cookies.
 */
function displayCookies() {
  var ca = document.cookie.split(";");

  document.write('&lt;div class="square">');
  document.write("&lt;p>Press ctrl-Esc to delete the 'username' cookie!&lt;/p>");
  document.write(
    `&lt;h2>Found the following ${ca.length} cookies:&lt;/h2>\n&lt;ul style="margin-left:em;">`
  );
  for (let c of ca) {
    let cookie = c.split("=")[0].trimStart();
    let value = getCookie(cookie);
    if (cookie == "username")
      document.write(`&lt;li style="color: red;">${cookie}: ${value}&lt;/li>`);
    else document.write(`&lt;li>${cookie}: ${value}&lt;/li>`);
  }
  document.write("&lt;/ul>");
  if (ca.length > 0) {
    document.write(`&lt;p>Click &lt;a href=${window.location.pathname}>here&lt;/a> to go back
        and &lt;a href="https://klauslaube.com.br/2012/04/05/entendendo-os-cookies-e-sessoes.html">here&lt;/a> to know more.&lt;/p>`);
  }
  document.write("&lt;/div>");
}

/**
 * Display all cookies by creating new DOM nodes.
 *
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild
 * @see https://www.javatpoint.com/javascript-queryselector
 */
function displayAllCookies() {
  var ca = document.cookie.split(";");

  // search and return the first element for the given CSS selector within the document
  let div = document.querySelector(".square");
  let newdiv = document.createElement("div");
  if (div == undefined) document.body.appendChild(newdiv);
  else document.body.replaceChild(newdiv, div);
  newdiv.className = "square";
  newdiv.innerHTML += "&lt;p>Press ctrl-Esc to delete the 'username' cookie!&lt;/p>";
  newdiv.innerHTML += `&lt;h2>Found the following ${ca.length} cookies:&lt;/h2>\n&lt;ul style="margin-left:em;">`;
  for (let c of ca) {
    let cookie = c.split("=")[0].trimStart();
    let value = getCookie(cookie);
    if (cookie == "username")
      newdiv.innerHTML += `&lt;li style="color: red;">${cookie}: ${value}&lt;/li>`;
    else newdiv.innerHTML += `&lt;li>${cookie}: ${value}&lt;/li>`;
  }
  if (ca.length > 0) {
    newdiv.innerHTML += `&lt;p>Click &lt;a href=${window.location.pathname}>here&lt;/a>
      to go back and &lt;a href="https://klauslaube.com.br/2012/04/05/entendendo-os-cookies-e-sessoes.html">here&lt;/a>
      to know more.&lt;/p>`;
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#checkCookie">checkCookie</a></li><li><a href="global.html#deleteCookie">deleteCookie</a></li><li><a href="global.html#displayAllCookies">displayAllCookies</a></li><li><a href="global.html#displayCookies">displayCookies</a></li><li><a href="global.html#getCookie">getCookie</a></li><li><a href="global.html#setCookie">setCookie</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Sat Sep 02 2023 08:45:06 GMT-0300 (Brasilia Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
