<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: roman-storage.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: roman-storage.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module */

/**
 *  @file
 *
 *  &lt;p>Remember the values of the last conversion.&lt;/p>
 *
 *  &lt;p>After submitting the form, all of the local javascript data is gone, and
 *  the page is reloaded, which may cause some flicker.&lt;/p>
 *
 *  &lt;p>Therefore, the data has to be to stored some way, with either PHP, Local Storage, or Cookies.
 *  The advantages of using forms are their properties, such as error handling.&lt;/p>
 *
 *  &lt;p>localStorage is similar to sessionStorage, except that while localStorage data has no expiration time,
 *  sessionStorage data gets cleared when the page session ends â€” that is, when the page is closed.&lt;/p>
 *
 *  &lt;p>localStorage data for a document loaded in a "private browsing" or "incognito" session
 *  is cleared when the last "private" tab is closed.&lt;/p>
 *
 *  &lt;p>If there IS a submit button, it will be clicked when one presses Enter in a text field.&lt;/p>
 *
 *  &lt;p>Since there is no server here, there is nothing to submit,
 *  and of course, there would be no need of a local storage, other than remembering the
 *  state for the next execution.&lt;/p>
 *
 *  &lt;p>In this case, we could either have used:&lt;/p>
 *  &lt;pre>
 *      document.getElementById("roman_button").addEventListener("click", function(event){
 *          event.preventDefault();
 *          ...
 *       });
 *
 *      or (one of the two buttons could have type="button", in this case).
 *      document.getElementById("romanform").onsubmit=function(e) {
 *          e.preventDefault();
 *          ...
 *      }
 *  &lt;/pre>
 * @see https://support.mozilla.org/en-US/kb/cookies-information-websites-store-on-your-computer
 * @see https://stackoverflow.com/questions/8634058/where-the-sessionstorage-and-localstorage-stored
 * @see &lt;a href="../roman/roman-storage.js">source&lt;/a>
 */

import { int2roman, int2romanFast, roman2int, validateRoman } from "./roman.js";

// Module creates a scope to avoid name collisions.
// Either expose your function to window object or use addEventListener to bind handler.
window.restoreValues = restoreValues;
window.storeValues = storeValues;

/** Accesses the current domain's local Storage object and reads a data item from it using Storage.getItem().
 *
 *  @see https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage
 */
function restoreValues() {
  if (localStorage.getItem("decimal-value") !== null)
    decimal.value = localStorage.getItem("decimal-value");
  if (localStorage.getItem("roman-value") !== null)
    roman.value = localStorage.getItem("roman-value");
}

/** Accesses the current domain's local Storage object and adds a data item to it using Storage.setItem().
 *
 *  @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API
 */
function storeValues() {
  if (typeof Storage !== "undefined") {
    localStorage.setItem("decimal-value", decimal.value);
    localStorage.setItem("roman-value", roman.value);
  }
}

/**
 * Convert from integer to roman.
 * @param {MouseEvent} e button click event.
 * @function decimal button click
 * @global
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault
 * @see &lt;a href="/cwdc/3-javascript/doc-roman/module-roman.html#int2romanFast">int2romanFast&lt;/a>
 */
roman_button.onclick = function (e) {
  e.preventDefault(); // there is no server - nothing to submit
  roman.value = int2romanFast(decimal.value);
  storeValues();
};

/**
 * Convert from integer to roman.
 * @param {InputEvent} e oninput event.
 * @function decimal string typed
 * @global
 * @see &lt;a href="/cwdc/3-javascript/doc-roman/module-roman.html#int2romanFast">int2romanFast&lt;/a>
 */
$('[name="decimal"]').on("change keyup", function () {
  let value = $(this).val();
  $('[name="roman"]').val(int2romanFast(value));
});

/**
 * Convert from roman to integer.
 * @param {InputEvent} e oninput event.
 * @function roman string typed
 * @global
 * @see &lt;a href="/cwdc/3-javascript/doc-roman/module-roman.html#roman2int">roman2int&lt;/a>
 */
roman.oninput = function () {
  decimal.value =
    validateRoman(roman.value).length == 0 ? roman2int(roman.value) : 0;
};

/**
 * Convert from roman to integer.
 * @param {MouseEvent} e button click event.
 * @function roman button click
 * @global
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault
 * @see &lt;a href="/cwdc/3-javascript/doc-roman/module-roman.html#roman2int">roman2int&lt;/a>
 */
decimal_button.onclick = function (e) {
  e.preventDefault(); // there is no server - nothing to submit
  var val = validateRoman(roman.value);
  decimal.value = val.length == 0 ? roman2int(roman.value) : 0;
  if (decimal.value == 0) {
    alert(`Exception ${val} : Invalid roman "${roman.value}"`);
  } else {
    storeValues();
  }
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-roman.html">roman</a></li><li><a href="module-roman-storage.html">roman-storage</a></li></ul><h3>Global</h3><ul><li><a href="global.html#decimalbuttonclick">decimal button click</a></li><li><a href="global.html#decimalstringtyped">decimal string typed</a></li><li><a href="global.html#romanbuttonclick">roman button click</a></li><li><a href="global.html#romanstringtyped">roman string typed</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Sat Sep 02 2023 08:45:04 GMT-0300 (Brasilia Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
